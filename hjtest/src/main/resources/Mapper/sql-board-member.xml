<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.hjtest.mapper.BoardMapper">

    <resultMap id="boardResultMap" type="com.example.hjtest.Dto.BoardDto">
        <result property="boardId" column="board_id"/>
        <result property="title" column="title"/>
        <result property="contents" column="contents"/>
        <result property="hitCnt" column="hit_cnt"/>
        <result property="email" column="email"/>
        <result property="createdDatetime" column="created_datetime"/>
        <result property="updatedDatetime" column="updated_datetime"/>
    </resultMap>

    <select id="searchBoards" resultMap="boardResultMap">
        <![CDATA[
            SELECT
                board_id, title, contents, hit_cnt, email, created_datetime, updated_datetime
            FROM t_board
            WHERE
                <choose>
                    <when test="searchType == 'title'">
                        title LIKE CONCAT('%', #{searchTerm}, '%')
                    </when>
                    <when test="searchType == 'email'">
                        email LIKE CONCAT('%', #{searchTerm}, '%')
                    </when>
                    <otherwise>
                        title LIKE CONCAT('%', #{searchTerm}, '%')
                        OR contents LIKE CONCAT('%', #{searchTerm}, '%')
                        OR email LIKE CONCAT('%', #{searchTerm}, '%')
                    </otherwise>
                </choose>
            ORDER BY board_id DESC
          ]]>
    </select>

</mapper>